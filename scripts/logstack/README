#
# Copyright IBM Corporation 2020,2021
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

EFK log stack install
=======================

cd kar/scripts/efk

With k3d cluster running, add a new cluster node to host EFK specific pods by running:
./add-efk-node.sh

To deploy EFK log stack, run the following from kar/scripts:
./start-k3d-logstack.sh

Once EFK log stack deploys succefully, access Kibana GUI by forwarding local port to the Kubernetes node hosting Kibana pod.

kubectl port-forward svc/kibana 5602:5601 --namespace=logging

Deploy reefer application.

Next, in your web browser, visit the following URL: http://localhost:5602
When the GUI loads, there is a vertical menu on the very left side of the app. The first active icon (from the top) in this menu will
show "Discover" in its tooltip., click it to show "Create Index Pattern" screen with Index Pattern value= index-patttern-*. Replace the
value with logstash-*, and press Next Step button. You will then see "Configure Settings" screen. Click on a drop-down
selector and choose "@timestamp" field, and hit Create Index Pattern button. Now, hit Discover again on the left hand navigation menu.
You should see log entries from the reefer app, sorted by time (newest on top).


To remove EFK log stack, run the following from kar/scripts:
./stop-k3d-logstack.sh



