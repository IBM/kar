kind: Cluster
apiVersion: kind.x-k8s.io/v1alpha4
nodes:
- role: control-plane
  kubeadmConfigPatches:
  - |
    kind: InitConfiguration
    nodeRegistration:
      kubeletExtraArgs:
        node-labels: "ingress-ready=true"
        authorization-mode: "AlwaysAllow"
  extraPortMappings:
  # http forwarded to nginx-ingress
  - containerPort: 80
    hostPort: 31080
    protocol: TCP
  # https forwarded to nginx-ingress
  - containerPort: 443
    hostPort: 31443
    protocol: TCP
- role: worker
  extraPortMappings:
  # forwarded to kar-system/kar-redis-0
  - containerPort: 31379
    hostPort: 31379
    protocol: TCP
  # forwarded to kar-system/kar-kafka-0
  - containerPort: 31093
    hostPort: 31093
    protocol: TCP
